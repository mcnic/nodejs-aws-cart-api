generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["prismaSchemaFolder", "relationJoins", "fullTextSearch", "fullTextIndex"]
  // fix error in Lambda 'Prisma Client could not locate the Query Engine for runtime "rhel-openssl-3.0.x".'
  binaryTargets   = ["native", "rhel-openssl-3.0.x"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Product {
  id          String     @id @default(uuid())
  title       String
  description String
  price       Float
  image       String
  items       CartItem[]

  @@map("products")
}

model CartItem {
  cart_id    String
  product_id String
  count      Int      @default(0)
  cart       Cart     @relation(fields: [cart_id], references: [id], onDelete: Cascade, onUpdate: Cascade)
  product    Product? @relation(fields: [product_id], references: [id])

  @@id([cart_id, product_id])
  @@map("cart_items")
}

enum CartStatuses {
  OPEN
  ORDERED
}

model Cart {
  id         String       @id @default(uuid())
  user_id    String
  created_at DateTime     @default(now())
  updated_at DateTime     @default(now())
  status     CartStatuses @default(OPEN)
  items      CartItem[]
  user       User         @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: Cascade)

  @@map("carts")
}

model User {
  id       String @id @default(uuid())
  name     String @unique
  password String
  carts    Cart[]

  @@map("users")
}
